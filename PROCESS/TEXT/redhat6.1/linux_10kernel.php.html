<!DOCTYPE HTML PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>


   <meta http-equiv="Content-Type" content="text/html; charset=utf8">
   <meta name="Author" content="VBird">
   <title>鸟哥的 Linux 私房菜 -- 核心编译</title>
<style>
   <!--
   body{background-image:url(http://linux.vbird.org/images/VBirdLinux.jpg);
	background-ATTACHMENT:FIXED}
   -->
</style>
</head><body>


<!-- Copyright  2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  (Unregistered) on  02/12/15 12:14:49.<br>
<b>Address:</b> <a class="info" href="http://vbird.dic.ksu.edu.tw/linux_basic/redhat6.1/linux_10kernel.php">http://vbird.dic.ksu.edu.tw/linux_basic/redhat6.1/linux_10kernel.php</a><br>
<b>Title:</b> 鸟哥的 Linux 私房菜 -- 核心编译 &nbsp;&bull;&nbsp; <b>Size:</b> 34240<br></div>
<!-- /Copyright  2005. Spidersoft Ltd -->


<center><b><font color="#3333ff"><font size="+2"><font face="标楷体">鸟哥的</font><font face="Times New Roman,Times"> Linux </font><font face="标楷体">与</font><font face="Times New Roman,Times"> ADSL </font><font face="标楷体">私房菜</font></font></font></b>
<br>
<a href="http://linux.vbird.org/" target="_top"><img src="linux_10kernel_files/VBirdTitle2.jpg" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_basic"><img src="linux_10kernel_files/icon_system.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_server"><img src="linux_10kernel_files/icon_server.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_security"><img src="linux_10kernel_files/icon_security.jpg" nosave="" width="90" border="0" height="25"></a>
<a href="http://phorum.vbird.org/" target="_blank"><img src="linux_10kernel_files/icon_forums.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/adsl"><img src="linux_10kernel_files/icon_adsl.gif" nosave="" width="90" border="0" height="25"></a>
<br>
<hr width="100%">
</center>
<center><font color="#3333ff"><font size="+2"><font face="标楷体">核心编译(</font><font face="Times New Roman Baltic">kernel</font><font face="标楷体">)</font></font></font></center>

<div align="right"><font face="新细明体"><font color="#3333ff"><font size="-1">最近更新日期：2001/08/17</font></font></font></div>
<font face="标楷体"><font color="#000099"><font size="+1"><a href="#otherupdates">前言</a></font></font></font>
<br><font face="标楷体"><font color="#000099"><font size="+1"><a href="#download">下载新核心</a></font></font></font>
<br><font face="标楷体"><font color="#000099"><font size="+1"><a href="#setup">开始设定核心的内容</a></font></font></font>
<br><font face="标楷体"><font color="#000099"><font size="+1"><a href="#compile">开始编译</a></font></font></font>
<br><font color="#000099"><font size="+1"><a href="#install_kernel"><font face="标楷体">安装编译完成的核心及设定多重引导选项
</font><font face="Times New Roman Baltic">lilo</font></a></font></font>
<br>
<hr width="100%">
<br><a name="1-first"></a><font face="标楷体"><font color="#000099"><font size="+1">前言</font></font></font>
<blockquote>其实应该在安装完 Linux 
之后便开始编译核心，因为每个人所需要的核心都并不相同！举个例子来说，你安装了一个很新的网络卡，但是你的核心并不支持这一种网络卡，那你只好下载比较
新的核心来编译，才能支持你的网络卡！另外，由于太大的核心对于整体的执行效能会比较慢，所以适当的核心对于你的
Linux 系统之执行效率也是有帮助的！因此，一般的玩家通常在安装完了 Linux
之后，便开始进行核心的重新编译工作！
<p>在 <a href="http://www.study-area.org/linux/linuxfr.htm" target="_blank">study-area</a>
也曾提到：<i>Linux的灵魂所在﹐其实就是其<font color="#000099">稳定</font>的核心设计。我们可以将之看成是一个架于程序和硬件之间的界面操作系统﹐离开来核心﹐什么东西都用不了。而核心的编译好坏﹐也会影响到系统的效能﹐甚至﹐一些系统功能(如
ip networking)﹐就必须要编进核心才行。</i>
</p><p>不过，由于核心的更新速度太快了，如果你一直执着于最新的核心编译，那肯定会吃不消，所以通常我们的建议就是，除非你有新的需求，否则可以不用常常去更新核心的！</p></blockquote>

<hr width="100%">
<br><a name="download"></a><font face="标楷体"><font color="#000099"><font size="+1">下载新核心</font></font></font>
<ul>
<li>
<font color="#000099">核心的版本</font><font color="#000000">：</font></li>
</ul>

<ul><font color="#000000">要如何知道你的核心版本呢？基本上，你在开机进入
Linux 的 login 画面时， Redhat 应该就已经告诉你这个主机的核心版本了，不过，如果你要知道你的核心版本的话，可以输入：</font>
<br>&nbsp;
<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/root]# uname -r</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">2.2.12-20</font></font></font></td>
</tr>
</tbody></table>
<font color="#000000">上面显示我们这个 Linux 核心是 2.2.12-20 这个版本。</font>
<p><font color="#000000">好啦，那要选择哪一个核心版本呢？目前你可以看到的核心版本主要有
</font><font color="#000099">2.2.X</font><font color="#000000">,
</font><font color="#000099">2.3.X</font><font color="#000000">
及 </font><font color="#000099">2.4.X</font><font color="#000000">，哪一个才适合你呢？我想，既然我们需要的是稳定版的
Linux ，那自然选择越稳定的越好啰，那基本上，所</font><font color="#000099">有
2.2.X 及 2.4.X 的都是属于稳定型的核心版本，至于 2.3.X 则是适合开发 Linux
软件的核心！</font><font color="#000000">另外，2.4.X并不是比2.2.X还新的意思，基本上，所有
2.2.X 及 2.3.X 与 2.4.X 都是同时开发的核心，只是因为其支持的程度或者是一些功能方面不完全相同，所以才会分成这些版本！而目前我们所想要使用的应该是
2.2.X 这个版本的系列核心，截至目前为止，这一版的最新核心应该是 2.2.19 这一个，当然，你也可以下载其他的核心！</font></p></ul>

<ul>
<li>
<font color="#000099">核心下载地点</font><font color="#000000">：</font></li>
</ul>

<ul><font color="#000000">Linux 核心的下载地点可以在底下的地点找到最新的，当然也可以在台湾相关的
FTP 站找到你要的核心。</font>
<br>&nbsp;
<ul>
<li>
<font color="#000000"><a href="http://www.kernel.org/pub/linux/kernel/" target="_blank">http://www.kernel.org/</a></font></li>

<li>
<font color="#000000"><a href="ftp://linux.cis.nctu.edu.tw/kernel/" target="_blank">交大资科</a></font></li>

<li>
<font color="#000000"><a href="ftp://nctuccca.edu.tw/OS/Linux/kernel/" target="_blank">教育部</a></font></li>
</ul>

<p><br><font color="#000000">另外，你也可以在我这里下载 linux-2.2.19.tar.gz
这个核心版本。基本上，最好是在系统安装完毕之后马上就进行核心编译工作，免得以后每次装一些特定功能的时候又要花一大轮时间编译。另外要说明的，由于小弟是以
2.2.18 这一版的核心来做升级的动作，所以以下是以 2.2.18 来做示范！</font>
<br>&nbsp;
</p><li>
<font color="#000099">核心解压缩</font><font color="#000000">：</font></li>

<br><font color="#000000">下载下来的核心大致上都是 *.tar.gz 这种压缩文件，所以需要先解压缩，另外，由于
redhat 默认的编译核心的目录是 /usr/src/linux ，所以你要将这个压缩文件解至这个目录。不过由于系统原本就有一个
linux 的连结档在这里，所以你要先取消连结档。现在假设你的 linux-2.2.18.tar.gz
放在 /root/ 底下，则你可以这样做：</font>
<br>&nbsp;
<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/root]# cd /usr/src/</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
src]# rm linux</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
src]# tar -zxvf /root/linux-2.2.18.tar.gz</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
src]# mv linux linux-2.2.18</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
src]# ln -s linux-2.2.18 linux</font></font></font></td>
</tr>
</tbody></table>
<font color="#000000">则你的新核心数据放在 linux-2.2.18 这个目录中，而
linux 则是链接至这个目录的链接目录！</font></ul>

<hr width="100%">
<br><a name="setup"></a><font face="标楷体"><font color="#000099"><font size="+1">开始设定核心的内容</font></font></font>
<blockquote><font color="#000000">编译核心有许多方法，这里以窗口接口的方法来说明：</font>
<ol>
<li>
<font color="#000099">进入核心目录</font><font color="#000000">：</font><font face="细明体"><font color="#3333ff">
cd /usr/src/linux</font></font></li>

<br>&nbsp;
<li>
<font color="#000099">开始设定画面</font><font color="#000000">： </font><font face="细明体"><font color="#3333ff">make
menuconfig</font></font></li>

<br>&nbsp;
<li>
<font color="#000099">进入选择项目</font><font color="#000000">：</font></li>

<br><font color="#000000">进入选择项目之后，你将会在窗口接口中看到很多的选项，</font><font color="#000099">请使用箭头键、空格键与
enter 来进行选择</font><font color="#000000">。以下开始你要慢慢的详细挑选，如果有任何问题的话，请详细的看一下每一个选项中的
Help 。另外，如果没有需要的话，请尽量不要把核心边的太大！否则效能是会降低的喔！此外，由于很多时候你不晓得需不需要选择这个项目，那你可以将之编成模块（&lt;M&gt;
的项目），模块是在开机加载时有被加载才可以执行的咚咚！所以并不会使效能方面有太大的问题！</font>
<br>&nbsp;
<ul>
<li>
<font color="#000000"><b>Code maturity level options</b>：请选择。这个项目主要在让你可以接受一些测试的版本的套件。</font></li>

<li>
<font color="#000000"><b>Processor type and features</b>：请选择进入，选你的
CPU 形式。</font></li>

<ul>
<li>
<font color="#000000"><b>Processor family</b>：例如鸟哥的 CPU 为 P-166
则我可以选择 Pentium/K6/TSC/CyrixIII 这一项！</font></li>

<li>
<font color="#000000"><b>Math emulation</b>：这一项请不要选择，因为这是用软件来仿真硬件的计算核心，因为我们的
CPU 都是 P-100 以后的，所以不用选这项！</font></li>

<li>
<font color="#000000"><b>Symmetric multi-processing support</b>：这是是否支持
双CPU 的主板的选项，你可以选择也可以不选择，但如果你使用双CPU主板，这个就一定要选择。</font></li>

<li>
<font color="#000000">其他保持默认值即可。</font></li>
</ul>

<li>
<font color="#000000"><b>Loadable module support</b>：请选择，这是用来是否支持模块加载的。</font></li>

<ul>
<li>
<font color="#000000"><b>Enable loadable module support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>Set version information on all symbols for modules</b>：不要选，因为我们可能会具有两种以上的版本的核心，所以这一项不可选择。</font></li>

<li>
<font color="#000000"><b>Kernel module loader</b>：请选择。</font></li>
</ul>

<li>
<font color="#000000"><b>General setup</b>：</font></li>

<ul>
<li>
<font color="#000000"><b>Networkking support</b>：一定要选择。</font></li>

<li>
<font color="#000000"><b>PCI support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>Advanced Power management BIOS support</b>：如果您的BIOS支持APM的话﹐请选择。</font></li>

<li>
<font color="#000000"><b>Power off on shutdown</b>：如果您选择了上一个﹐也请选择。</font></li>

<li>
<font color="#000000">其他，保留预设，或视实际情况设定。 例如我们实验室的机器需要与
SGI 的机器联系，所以就多选择了 SGI Visual Workstation support 这一项。</font></li>
</ul>

<li>
<font color="#000000"><b>Plug and Play support</b>：将之全部选择。</font></li>

<li>
<font color="#000000"><b>Block devices</b>：里面放置了一些芯片组的选项，通常以默认值就可以了，不过，如果你的主板是最近的版子，例如
VIA 的&nbsp; 82C586 芯片组，哪就必须进来选择你的芯片组啦！</font></li>

<li>
<font color="#000000"><b>Networking options</b>：这是所有项目里面最重要的了，底下的选择</font></li>

<ul>
<li>
<font color="#000000"><b>Network firewalls</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>Socket Filtering</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>TCP/IP networking</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: multicasting</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: advanced router</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: police routing</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: verbose route monitoring</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: firewalling</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: use FWMARK value as routing key</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: transparent proxy support</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: masquerading</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: ICMP masquerading</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: masquerading special modules support</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: ipautofw masq support</b>﹐请选择为 Module。</font></li>

<li>
<font color="#000000"><b>IP: ipportfw masq suppor</b>t﹐请选择为 Module。</font></li>

<li>
<font color="#000000"><b>IP: ip fwmark masq-forwarding support</b>﹐请选择为
Module。</font></li>

<li>
<font color="#000000"><b>IP: optimize as router not host</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: multicast routing</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IP: aliasing support</b>﹐请选择。</font></li>

<li>
<font color="#000000"><b>IPX: Full internal IPX network</b>﹐如果您的网络有Novell服务器﹐请选择。</font></li>

<li>
<font color="#000000"><b>IPX: SPX networking</b>﹐如果您的网络有Novell服务器﹐请选择。</font></li>

<li>
<font color="#000000">其他﹐保留预设﹐或视实际情况设定。</font></li>
</ul>

<li>
<font color="#000000"><b>Telephony Support</b>：保留默认值。</font></li>

<li>
<font color="#000000"><b>SCSI support</b>：除非你有 SCSI 的设备，否则可以选择成为
M 的模块型态。</font></li>

<li>
<font color="#000000"><b>Network device support</b>：这个也是很重要的选项，与你的网络卡有关！</font></li>

<ul>
<li>
<font color="#000000"><b>Dummy net driver support</b>：非常建议选择。</font></li>

<li>
<font color="#000000"><b>Ethernet (10 or 100Mbit)</b>：除非您使用其他的网络形态﹐否则这个一定要选择。</font></li>

<ul>
<li>
<font color="#000000"><b>3 COM cards</b>：除非您的网络卡是这个牌子的﹐否则不选择。</font></li>

<li>
<font color="#000000"><b>Western Digital/SMC cards</b>：除非您的网络卡是这个牌子的(或兼容)﹐否则不选择。</font></li>

<li>
<font color="#000000"><b>RealTek 8912/8139 (not 8019/9029!) support</b>：除非您的网络卡是这
8912或8139这两个确切型号﹐否则不选择﹐不过﹐也可以选“M”。</font></li>

<li>
<font color="#000000"><b>Other ISA cards</b>：如果您有ISA网卡的话﹐可以选择。</font></li>

<li>
<font color="#000000"><b>NE2000/NE1000 support</b>：如果您不知道您的网络卡型号﹐这个可以试试选择。</font></li>

<li>
<font color="#000000"><b>EISA, VLB, PCI and on board controllers</b>：请选择。</font></li>

<li>
<font color="#000000"><b>PCI NE2000 support</b>：如果您用的是PCI网络卡﹐又不知道型号﹐这个可以试试选择。</font></li>

<li>
<font color="#000000"><b>EtherExpressPro/100 support</b>：如果您有此类网卡﹐请选择。</font></li>

<li>
<font color="#000000"><b>Pocket and protable adaptors</b>：如果您使用PCMCIA网卡﹐可以试试选择。</font></li>

<li>
<font color="#000000">基本上在这个选项当中，就是选你有的网络卡的形式就对了！</font></li>
</ul>

<li>
<font color="#000000"><b>FDDI driver support</b>：如果您没用使用FDDI﹐请不要选择。</font></li>

<li>
<font color="#000000"><b>Frame relay DLCI support</b>：如果您没用使用Frame
relay﹐请不要选择。</font></li>

<li>
<font color="#000000"><b>PPP (point-to-point) support</b>：这个一定要选择。</font></li>

<li>
<font color="#000000"><b>SLIP (serial line) support</b>：如果您知道您ISP使用SLIP﹐可以选择。</font></li>

<li>
<font color="#000000"><b>Token Ring driver support</b>：如果您的网络不是这个形态﹐请不要选择。</font></li>

<li>
<font color="#000000">至于其他﹐如果确定不使用的﹐就不要选择﹐如果不确定﹐可以保留预设﹐或将之设成“M”。</font></li>
</ul>

<li>
<font color="#000000"><b>Amateur Radio support </b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>IrDA (infrared) support</b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>ISDN subsystem</b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>Old CD-ROM drivers (not SCSI, not IDE)</b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>Character devices</b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>USB support</b>：有才选择，通常不选。</font></li>

<li>
<font color="#000000"><b>Filesystems</b>：这个与你的 Linux 系统可支持的档案型态有关，一定要进来选择。</font></li>

<ul>
<li>
<font color="#000000"><b>Quota support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>DOS FAT fs support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>MSDOS fs support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>VFAT (Windows-95) fs support</b>：请选择。</font></li>

<li>
<font color="#000000"><b>ISO 9660 CDROM filesystem support：</b>请选择。</font></li>

<li>
<font color="#000000"><b>Microsoft Joliet CDROM extensions</b>：请选择。</font></li>

<li>
<font color="#000000"><b>NTFS filesystem support (read only)</b>：请选择。</font></li>

<li>
<font color="#000000"><b>OS2/HPFS filessystem support (read only)：</b>如果您的机器还有OS/2系统﹐请选择。</font></li>

<li>
<font color="#000000"><b>Network File Systems</b>：请展开﹐喜欢的话﹐可以全部选择﹐但我们只关心‘NFS’和‘SMB’的部分。</font></li>

<li>
<font color="#000000"><b>Partition Types</b>：除非您找到相关项目﹐否则可以不理会。</font></li>

<li>
<font color="#000000"><b>Native Language Support</b>：请展开﹐然后选择﹕</font></li>

<ul>
<li>
<b><font color="#000000">Codepage 850</font></b></li>

<li>
<b><font color="#000000">Codepage 950</font></b></li>

<li>
<b><font color="#000000">NLS ISO 8859-1</font></b></li>
</ul>
</ul>

<li>
<font color="#000000"><b>Console drivers</b>：除非您确定﹐否则保留预设。</font></li>

<li>
<font color="#000000"><b>Sound：</b>如果您用的是Creative的SB16﹐或兼容声卡﹐可以不理会。</font></li>

<li>
<font color="#000000"><b>Kernel hacking</b>：保留预设则可。</font></li>
</ul>

<p><br><font color="#000000">这样就编完了，请按下『exit』然后选择 save
后，即可离开窗口画面。</font>
<br>&nbsp;
</p><li>
<font color="#000099">更改前一版的模块目录</font><font color="#000000">：</font></li>

<br><font color="#000000">再来则是要开始让系统编译你刚刚设定的核心了，此时请注意，如果你使用的核心版本之前你已经有编过一次了，那样的话，在</font><font color="#3333ff">
/lib/modules</font><font color="#000000"> 这个目录中应该会有前一版的模块，这时请到这个目录下将该核心目录更改名称。不过我们这里由于是第一次编译核心，所以在
/ib/modules 里面应该只有 2.2.12-20 这个目录，因此这一步就不用作了。</font></ol>
</blockquote>

<hr width="100%">
<br><a name="compile"></a><font face="标楷体"><font color="#000099"><font size="+1">开始编译</font></font></font>
<blockquote><font color="#000000">这个时候要开始编译我们的核心了，其实也是很简单，直接执行以下几个步骤即可：</font>
<br>&nbsp;
<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make dep</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make clean</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make modules</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">这个步骤要花点时间的，所以按下
enter 后就可以去看电视了！</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make modules_install</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make bzImage</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">这个步骤是最久的一步，也请你去喝个茶吧！</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">这时才开始编译核心。其实有两种编译核心的方法，</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">分别是 make
bzImage 及 make zImage，有何不同？</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">在 bzImage
编译的核心是经过压缩的，由于我们目前编的核心</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">都蛮大的，所以需要
bzImage 这个指令，如果你选择的核心很小，</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">就可以使用
make zImage 了（据说比较快一点）。</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# make bzlilo</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">最后一动啦，将核心安装在硬盘之上。</font></font></font></td>
</tr>
</tbody></table>

<p><font color="#000000">在执行 make modules_install 后，会在你的 /lib/modules
形成一个专属于这个核心的模块目录，而在执行 make bzImage 成功之后，会在你的<b>根目录</b>造成两个重要的档案，就是我们最重要的核心开机程序了，分别是：</font><font color="#3333ff">vmlinuz</font><font color="#000000">
及 </font><font color="#3333ff">System.map</font><font color="#000000">
这两个档案。</font></p></blockquote>

<hr width="100%">
<br><a name="install_kernel"></a><font color="#000099"><font size="+1"><font face="标楷体">安装编译完成的核心及设定多重引导选项
</font><font face="Times New Roman Baltic">lilo</font></font></font>
<blockquote><font color="#000000">好了，编译完就是要安装啦！由于害怕刚刚编译完的核心不能正常的开机，所以通常鸟哥都是手动来设定成多重引导的选单，好让我们如果发生错误的设定，可以直接再次开机来进入
Linux 系统。</font>
<ol>
<li>
<font color="#000099">移动两个主要的开机档到 /boot 中</font><font color="#000000">：并加以更改名称</font></li>

<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
linux]# cd /</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/]# mv System.map /boot/System.map-2.2.18</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/]# mv vmlinuz /boot/vmlinux-2.2.18</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/]# cd /boot</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/boot]# rm System.map</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/boot]# ln -s System.map-2.2.18 System.map</font></font></font></td>
</tr>
</tbody></table>
<font color="#000000">如此一来，则你的开机执行的 System.map 会找寻 2.2.18
这一版的信息！</font>
<br>&nbsp;
<li>
<font color="#000099">编辑你的 /etc/lilo.conf 多重引导配置文件</font><font color="#000000">：</font></li>

<br><font color="#000000">这里就必须比较小心了，因为设定错误会让你开不了机的！只要设定一个档案就好了，那就是
/etc/lilo.conf 这个档案。</font>
<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/boot]# vi /etc/lilo.conf</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">进入 vi 的编辑画面，原始的
lilo.conf 有点像这样：</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">----</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">boot=/dev/hda</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">map=/boot/map</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">install=/boot/boot.b</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">prompt</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">timeout=50</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">default=linux</font></font></font>
<p><font face="细明体"><font color="#ffffff"><font size="-1">image=/boot/vmlinuz-2.2.12-20</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
label=linux</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
initrd=/boot/initrd-2.2.12-20.img</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
read-only</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
root=/dev/hda5</font></font></font>
</p><p><font face="细明体"><font color="#ffffff"><font size="-1">other=/dev/hda1</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
label=windows</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">----</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">关于上述个相关的咚咚你可以到
<a href="http://linux.vbird.org/linux_basic/redhat6.1/linux_04begin_lilo.php#lilo">设定lilo</a>
去看，</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">而经过修改之后可以变成像是这样：</font></font></font>
<br><font face="细明体"><font color="#ffff00"><font size="-1">----</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">boot=/dev/hda</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">map=/boot/map</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">install=/boot/boot.b</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">prompt</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">timeout=50</font></font></font>
<br><font face="细明体"><font size="-1"><font color="#ffffff">default=linux-2.2.18
</font><font color="#ffff00">&lt;==预设以
2.2.18 开机</font></font></font>
</p><p><font face="细明体"><font color="#ffffff"><font size="-1">image=/boot/vmlinuz-2.2.12-20</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
label=linux-2.2.12-20</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
initrd=/boot/initrd-2.2.12-20.img</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
read-only</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
root=/dev/hda5</font></font></font>
</p><p><font face="细明体"><font size="-1"><font color="#ffffff">image=/boot/vmlinuz-2.2.18
</font><font color="#ffff00">&lt;==这是新的核心喔！</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
label=linux-2.2.18&nbsp;</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
read-only</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
root=/dev/hda5</font></font></font>
</p><p><font face="细明体"><font color="#ffffff"><font size="-1">other=/dev/hda1</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
label=windows</font></font></font></p></td>
</tr>
</tbody></table>
<font color="#000000">重要的地方在于 default=linux-2.2.18 这一行，以及
image=/boot/vmlinuz-2.2.18 两行，需要指定正确才行！基本上这样就设定成功了！</font>
<br>&nbsp;
<li>
<font color="#000099">启动 lilo </font><font color="#000000">：</font></li>

<br><font color="#000000">这个时候请打入：</font>
<table width="90%" bgcolor="#000000" cols="1">
<tbody><tr>
<td><font face="细明体"><font color="#ffffff"><font size="-1">[root@tsai
/boot]# lilo</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Added linux-2.2.12-20</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Added linux-2.2.18
*</font></font></font>
<br><font face="细明体"><font color="#ffffff"><font size="-1">Added windows</font></font></font></td>
</tr>
</tbody></table>
<font color="#000000">你会看到如上的说明，可以看到 linux-2.2.18 有打星号，这表示预设的开机档是以
linux-2.2.18 的核心来开机的！</font>
<br>&nbsp;
<li>
<font color="#000099">重新启动</font><font color="#000000">：</font></li>

<br><font color="#000000">现在你可以重新启动来测试一下你的核心了！当然，你也可以在开机过程中，出现
boot 时按下 tab 键，让你选择你要的开机档！</font>
<br>&nbsp;
<li>
<font color="#000099">换回旧核心</font><font color="#000000">：</font></li>

<br><font color="#000000">如果核心使用的不满意怎么办？你可以如此的换回来原先的核心：</font>
<ul>
<li>
<font color="#000000">进入 /boot 中，将 System.map 的连结档换成 System.map-2.2.12-20
这一个，</font></li>

<li>
<font color="#000000">编辑 /etc/lilo.conf 档案，将预设的开机档改成 linux-2.2.12-20
，</font></li>

<li>
<font color="#000000">最后再执行 lilo 即可！</font></li>
</ul>
</ol>
编译核心有时候会遇到许多麻烦﹐尤其是当您从一个旧的版本升级上来。建议您看看
kernel-HOWTO 和 modules mini-howto 之外﹐还应该看看 /usr/src/linux/Documentation
里面的文章﹐尤其是 Changes?modules.txt?kmod.txt 等。而且﹐在编译(make menuconfig)的过程中﹐对任何不明白的选项﹐应该看看
Help 是怎么说的﹐这非常重要。
<p>另外，由于编译核心并以新的核心开机之后，所有的模块都会到新的目录去，如以上面的例子来看，以新的核心开机时，模块的加载会跑到
<b><font color="#3333ff">/lib/modules/2.2.18</font></b>
中，所以如果你的网络卡不是模块中有的，而是自己安装的，那你得在重新安装一次到新的目录中，否则你的网络将无法连接喔！</p></blockquote>
<font face="新细明体"><font color="#3333ff"><font size="-1">2002/ 01/01以来统计人数</font></font></font>
<br><img src="linux_10kernel_files/Count.gif" nosave="" width="60" align="ABSCENTER" height="15"><hr width="100%">
<center>
<a href="http://linux.vbird.org/" target="_top"><img src="linux_10kernel_files/VBirdTitle2.jpg" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_basic"><img src="linux_10kernel_files/icon_system.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_server"><img src="linux_10kernel_files/icon_server.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/linux_security"><img src="linux_10kernel_files/icon_security.jpg" nosave="" width="90" border="0" height="25"></a>
<a href="http://phorum.vbird.org/" target="_blank"><img src="linux_10kernel_files/icon_forums.gif" nosave="" width="90" border="0" height="25"></a>
<a href="http://linux.vbird.org/adsl"><img src="linux_10kernel_files/icon_adsl.gif" nosave="" width="90" border="0" height="25"></a>
<br><font color="#000066"><font size="-1">Designed by <a href="mailto:vbird@mail.vbird.idv.tw">VBird</a>
during 2001-2004.&nbsp; Aerosol Lab.</font></font></center>
</body></html>
