<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="Author" content="lee">
	<meta name="Description" content="æµ…è°ˆå¤‡ä»½ç­–ç•¥å•Šï¼">
	<title>é¸Ÿå“¥çš„ Linux ç§æˆ¿èœ -- æµ…è°ˆå¤‡ä»½ç­–ç•¥</title>
    <script src="../script/SpryMenuBar.js" type="text/javascript"></script>
	<script src="../script/index.js" type="text/javascript"></script>
	<link href="../css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
    <link href="../css/main.css" rel="stylesheet" type="text/css" />
    </head><body style="margin: 0pt; padding: 0pt;" class="table"onload="MM_preloadImages('image/title_19.png','image/title_26.png','image/title_27.png','image/title_28.png','image/title_06.png','image/title_08.png','image/title_10.png','image/title_12.png')">


<!-- Copyright © 2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  (Unregistered) on  02/12/15 12:14:49.<br>
<b>Address:</b> <a class="info" href="http://vbird.dic.ksu.edu.tw/linux_basic/0580backup_3.php">http://vbird.dic.ksu.edu.tw/linux_basic/0580backup_3.php</a><br>
<b>Title:</b> é¸Ÿå“¥çš„ Linux ç§æˆ¿èœ -- æµ…è°ˆå¤‡ä»½ç­–ç•¥ &nbsp;&bull;&nbsp; <b>Size:</b> 22673<br></div>
<!-- /Copyright © 2005. Spidersoft Ltd -->



<center>
<div id="apDiv5">
<div> <LINK REL="SHORTCUT ICON" HREF="favicon.ico">
<!-- ImageReady Slices (title3.ai) -->
<table id="___01" width="898" height="81" border="0" align="center" cellpadding="0" cellspacing="0";>
	<tr>
		<td colspan="15">
			<img src="image/title/title_01.png" width="900" height="1" alt=""></td>
	</tr>
	<tr>
		<td rowspan="4" bgcolor="#182448"><p><img src="http://linux.vbird.org/cgi-bin/Count.cgi?dd=C&ft=5&sh=T&md=8&pad=Y&df=vbird.dic.ksu.edu.tw.dat" width="93" align="left" title="è¨ˆæ•¸å™¨" /></p>
	    <p><font color="#FFFFFF" size="-1">since2012/04/23</font></p></td>
		<td rowspan="4" align="left" valign="top"><a href="http://vbird.dic.ksu.edu.tw/"><img src="image/title/title_03.png" alt="" width="263" height="79" border="0"></a></td>
		<td colspan="13">
			<img src="image/title/title_04.png" alt="" width="535" height="9" border="0"></td>
	</tr>
	<tr>
		<td rowspan="3">
			<img src="image/title/title_05.png" alt="" width="53" height="70" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="0110whatislinux.php.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image51','','image/title/title_06.png',1)"><img src="image/title/title3_06.png" name="Image51" width="106" height="25" border="0" id="Image51" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_07.png" alt="" width="27" height="37" border="0"></td>
		<td colspan="3" align="left" valign="top"><a href="http://vbird.dic.ksu.edu.tw/linux_server/0110network_basic.php" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image52','','image/title/title_08.png',1)"><img src="image/title/title3_08.png" name="Image52" width="107" height="25" border="0" id="Image52" alt=""/></a></td>
		<td rowspan="2">
			<img src="image/title/title_09.png" alt="" width="37" height="37" border="0"></td>
		<td colspan="2" align="left" valign="top"><a href="http://vbird.dic.ksu.edu.tw/about.php" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image53','','image/title/title_10.png',1)"><img src="image/title/title3_10.png" name="Image53" width="75" height="25" border="0" id="Image53" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_11.png" alt="" width="35" height="70" border="0"></td>
		<td align="left" valign="top"><a href="mailto:vbird@mail.vbird.idv.tw" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image54','','image/title/title_12.png',1)"><img src="image/title/title3_12.png" name="Image54" width="74" height="25" border="0" id="Image54" alt=""/></a></td>
		<td rowspan="3">
			<img src="image/title/title_13.png" alt="" width="21" height="70" border="0"></td>
	</tr>
	<tr>
		<td colspan="2">
			<img src="image/title/title_14.png" alt="" width="106" height="12" border="0"></td>
		<td colspan="3">
			<img src="image/title/title_15.png" alt="" width="107" height="12" border="0"></td>
		<td colspan="2">
			<img src="image/title/title_16.png" width="75" height="12" alt=""></td>
		<td rowspan="2">
			<img src="image/title/title_17.png" alt="" width="74" height="45" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/title_18.png" alt="" width="15" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar1" class="MenuBarHorizontal">
	  <li><a href="linux_basic.php.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image44','','image/title/title_19.png',1)"><img src="image/title/title3_19.png" name="Image44" width="123" height="33" border="0" id="Image44" /></a>
			    <ul>
			      <li><a href="Mandrake9.0/mandrake9.0.php.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image46','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image46" width="120" height="26" border="0" id="Image46" alt="" /></a></li>
                  <li><a href="fedora_4/fc4.php.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image47','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image47" width="120" height="26" border="0" id="Image47" alt="" /></a></li>
                  <li><a href="linux_basic.php.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image48','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image48" width="120" height="26" border="0" id="Image48" alt="" /></a></li>
                </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_20.png" alt="" width="42" height="33" border="0"></td>
		<td colspan="3" align="left" valign="top"><ul id="MenuBar2" class="MenuBarHorizontal">
	  <li><a href="http://vbird.dic.ksu.edu.tw/linux_server/" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image45','','image/title/title_21.png',1)"><img src="image/title/title3_21.png" name="Image45" width="125" height="33" border="0" id="Image45" /></a>
			    <ul>
			      <li><a href="http://vbird.dic.ksu.edu.tw/linux_server/linux_redhat9/redhat9.php" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image43','','image/title/title_26.png',1)"><img src="image/title/title_23.png" name="Image43" width="120" height="26" border="0" id="Image43" alt=""/></a></li>
			      <li><a href="http://vbird.dic.ksu.edu.tw/linux_server/centos4.php" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image49','','image/title/title_27.png',1)"><img src="image/title/title_24.png" name="Image49" width="120" height="26" border="0" id="Image49" alt="" /></a></li>
			      <li><a href="http://vbird.dic.ksu.edu.tw/linux_server/" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image50','','image/title/title_28.png',1)"><img src="image/title/title_25.png" name="Image50" width="120" height="26" border="0" id="Image50" alt="" /></a></li>
		        </ul>
		      </li>
		</ul></td>
		<td>
			<img src="image/title/title_22.png" alt="" width="47" height="33" border="0"></td>
	</tr>
	<tr>
		<td>
			<img src="image/title/Spacer.gif" width="101" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="263" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="53" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="15" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="91" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="27" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="5" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="42" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="60" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="37" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="28" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="47" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="35" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="74" height="1" alt=""></td>
		<td>
			<img src="image/title/Spacer.gif" width="22" height="1" alt=""></td>
	</tr>
</table>
<!-- End ImageReady Slices -->
<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
var MenuBar2 = new Spry.Widget.MenuBar("MenuBar2", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script></div>
<table summary="æœ¬æ–‡å†…å®¹çš„æ’ç‰ˆ" style="width: 898px;" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td style="width: 16px; height: 16px;">ã€€</td>
    <td style="width: 866px; height: 16px;">ã€€</td>
    <td style="width: 16px; height: 16px;">ã€€</td></tr>
<tr><td style="width: 16px; font-size: 6px;">ã€€</td>
    <td width="866">

<!-- æœ¬æ–‡çš„æ¡£å¤´éƒ¨åˆ† -->
<div style="text-align: center;">
    <a href="0580backup.php.html">
    <span class="text_head0">ç¬¬äºŒåäº”ç« ã€<span class="text_head_en"> Linux </span>å¤‡ä»½ç­–ç•¥</span></a><br>
</div>
    <div style="text-align: right;">
        <span class="text_history">æœ€è¿‘å‡çº§æ—¥æœŸï¼š2009/09/18</span>
    </div>

<!-- æœ¬æ–‡çš„è¿ç»“åŒºéƒ¨åˆ† -->
<div class="block1">
<span class="text_h1">
3. <a href="#VBird_strategy">VBird çš„å¤‡ä»½ç­–ç•¥ä¸ scripts</a><br>
	<span class="text_h2">
	ã€€ã€€3.1 <a href="#all_back">æ¯å‘¨ç³»ç»Ÿå¤‡ä»½çš„ script</a><br>
	ã€€ã€€3.2 <a href="#daily">æ¯æ—¥å¤‡ä»½æ•°æ®çš„ script</a><br>
	ã€€ã€€3.3 <a href="#remote">è¿œç¨‹å¤‡æ´çš„ script</a><br>
	</span>
</span></div>
<!-- æœ¬æ–‡çš„æ­£å¼éƒ¨åˆ† -->
<hr><a name="VBird_strategy"></a><img src="../image/logo.png" alt="å¤§æ ‡é¢˜çš„å›¾ç¤º" width="35" align="middle" height="34"><span class="text_h1">é¸Ÿå“¥çš„å¤‡ä»½ç­–ç•¥</span><br>
<div class="block1">
	<p>æ¯éƒ¨ä¸»æœºçš„ä»»åŠ¡éƒ½ä¸ç›¸åŒï¼Œé‡è¦çš„æ•°æ®ä¹Ÿä¸ç›¸åŒï¼Œé‡è¦æ€§ä¹Ÿä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œæ¯ä¸ªäººçš„å¤‡ä»½æ€è€ƒè§’åº¦éƒ½ä¸ä¸€æ ·ï¼
	æœ‰äº›å¤‡ä»½ç­–ç•¥æ˜¯éå¸¸æœ‰è¶£çš„ï¼ŒåŒ…æ‹¬ä½¿ç”¨å¤šä¸ªç£å¸¦æœºä¸ç£å¸¦æ¥è‡ªåŠ¨å¤‡ä»½ä¼ä¸šæ•°æ®å“© (<a href="#ps3">æ³¨3</a>) ã€‚</p>

	<p>å°±é¸Ÿå“¥çš„æƒ³æ³•æ¥è¯´ï¼Œé¸Ÿå“¥å¹¶æ²¡æœ‰æƒ³è¦å°†æ•´ä¸ªç³»ç»Ÿå®Œæ•´çš„å¤‡ä»½ä¸‹æ¥ï¼Œå› ä¸ºå¤ªè€—æ—¶é—´äº†ï¼è€Œä¸”å°±é¸Ÿå“¥çš„ç«‹åœºè€Œè¨€ï¼Œä¼¼ä¹ä¹Ÿæ²¡æœ‰è¿™ä¸ªå¿…è¦ï¼Œ
	æ‰€ä»¥é€šå¸¸é¸Ÿå“¥åªå¤‡ä»½è¾ƒä¸ºé‡è¦çš„æ–‡ä»¶è€Œå·²ï¼ä¸è¿‡ï¼Œç”±æ–¼é¸Ÿå“¥éœ€è¦å¤‡ä»½ /home ä¸ç½‘é¡µæ•°æ®ï¼Œå¦‚æœå¤©å¤©éƒ½å¤‡ä»½ï¼Œæˆ‘æƒ³ï¼Œç³»ç»Ÿè¿Ÿæ—©ä¼šå—ä¸äº† 
	(å› ä¸ºè¿™ä¸¤ä¸ªéƒ¨åˆ†å°±å·²ç»å å»æ•° 10 GB çš„ç£ç›˜ç©ºé—´...)ï¼Œæ‰€ä»¥é¸Ÿå“¥å°±å°†æˆ‘çš„å¤‡ä»½åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯æ¯æ—¥å¤‡ä»½ç»å¸¸æ€§å˜åŠ¨çš„é‡è¦æ•°æ®ï¼Œ
	ä¸€ä¸ªåˆ™æ˜¯æ¯å‘¨å¤‡ä»½å°±ä¸å¸¸å˜åŠ¨çš„èµ„è®¯ã€‚è¿™ä¸ªæ—¶å€™æˆ‘å°±å†™äº†ä¸¤ä¸ªç®€å•çš„ scripts ï¼Œåˆ†åˆ«æ¥å‚¨å­˜è¿™äº›æ•°æ®ã€‚</p>

	<p>æ‰€ä»¥é’ˆå¯¹é¸Ÿå“¥çš„ã€é¸Ÿç«™ã€æ¥è¯´ï¼Œæˆ‘çš„å¤‡ä»½ç­–ç•¥æ˜¯è¿™æ ·çš„ï¼š</p>

	<ol class="text_import2">
	<li>ä¸»æœºç¡¬ä»¶ï¼šä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„ filesystem æ¥å‚¨å­˜å¤‡ä»½æ•°æ®ï¼Œæ­¤ filesystem æŒ‚è½½åˆ° /backup å½“ä¸­ï¼›</li>
	<li>æ¯æ—¥è¿›è¡Œï¼šç›®å‰ä»…å¤‡ä»½ MySQL æ•°æ®åº“ï¼›</li>
	<li>æ¯å‘¨è¿›è¡Œï¼šåŒ…æ‹¬ /home, /var, /etc, /boot, /usr/local ç­‰ç›®å½•ä¸ç‰¹æ®ŠæœåŠ¡çš„ç›®å½•ï¼›</li>
	<li>è‡ªåŠ¨å¤„ç†ï¼šè¿™æ–¹é¢åˆ©ç”¨ /etc/crontab æ¥è‡ªåŠ¨æä¾›å¤‡ä»½çš„è¿›è¡Œï¼›</li>
	<li>å¼‚åœ°å¤‡æ´ï¼šæ¯æœˆå®šæœŸçš„å°†æ•°æ®åˆ†åˆ« (a)çƒ§å½•åˆ°å…‰ç›˜ä¸Šé¢ (b)ä½¿ç”¨ç½‘ç»œä¼ è¾“åˆ°å¦ä¸€éƒ¨æœºå™¨ä¸Šé¢ã€‚</li>
	</ol>

	<p>é‚£å°±æ¥çœ‹çœ‹é¸Ÿå“¥æ˜¯æ€ä¹ˆå¤‡ä»½çš„å§ï¼ ^_^<br><br></p>

	<hr><a name="all_back"></a><img src="../image/logo.png" alt="å°æ ‡é¢˜çš„å›¾ç¤º" width="24" align="middle" height="23"><span class="text_h2">æ¯å‘¨ç³»ç»Ÿå¤‡ä»½çš„ script</span><br>
	<div class="block2">
		<p>åº•ä¸‹æä¾›é¸Ÿå“¥çš„å¤‡ä»½çš„ scripts ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç‚¹å¸®åŠ©ï¼é¸Ÿå“¥å‡è®¾ä½ å·²ç»çŸ¥é“å¦‚ä½•æŒ‚è½½ä¸€ä¸ªæ–°çš„ 
		filesystem åˆ° /backup å»ï¼Œæ‰€ä»¥æ ¼å¼åŒ–ä¸æŒ‚è½½è¿™é‡Œå°±ä¸å†å¼ºè°ƒç½—ã€‚</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /backup/backupwk.sh</span>
#!/bin/bash
# ====================================================================
# ä½¿ç”¨è€…å‚æ•°è¾“å…¥ä½ç½®ï¼š
# basedir=ä½ ç”¨æ¥å‚¨å­˜æ­¤è„šæœ¬æ‰€é¢„è®¡å¤‡ä»½çš„æ•°æ®ä¹‹ç›®å½•(è¯·ç‹¬ç«‹æ–‡ä»¶ç³»ç»Ÿ)
<span class="term_write">basedir=/backup/weekly</span>  <span class="term_note">&lt;==æ‚¨åªè¦æ”¹è¿™é‡Œå°±å¥½äº†ï¼</span>

# ====================================================================
# åº•ä¸‹è¯·ä¸è¦ä¿®æ”¹äº†ï¼ç”¨é»˜è®¤å€¼å³å¯ï¼
PATH=/bin:/usr/bin:/sbin:/usr/sbin; export PATH
export LANG=C

# é…ç½®è¦å¤‡ä»½çš„æœåŠ¡çš„é…ç½®æ¡£ï¼Œä»¥åŠå¤‡ä»½çš„ç›®å½•
named=$basedir/named
postfixd=$basedir/postfix
vsftpd=$basedir/vsftp
sshd=$basedir/ssh
sambad=$basedir/samba
wwwd=$basedir/www
others=$basedir/others
userinfod=$basedir/userinfo
# åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™äºˆä»¥åˆ›å»ºã€‚
for dirs in $named $postfixd $vsftpd $sshd $sambad $wwwd $others $userinfod
do
	[ ! -d "$dirs" ] &amp;&amp; mkdir -p $dirs
done

# 1. å°†ç³»ç»Ÿä¸»è¦çš„æœåŠ¡ä¹‹é…ç½®æ¡£åˆ†åˆ«å¤‡ä»½ä¸‹æ¥ï¼ŒåŒæ—¶ä¹Ÿå¤‡ä»½ /etc å…¨éƒ¨ã€‚
cp -a /var/named/chroot/{etc,var}	$named
cp -a /etc/postfix /etc/dovecot.conf	$postfixd
cp -a /etc/vsftpd/*			$vsftpd
cp -a /etc/ssh/*			$sshd
cp -a /etc/samba/*			$sambad
cp -a /etc/{my.cnf,php.ini,httpd}	$wwwd
cd /var/lib
  tar -jpc -f $wwwd/mysql.tar.bz2 	mysql
cd /var/www
  tar -jpc -f $wwwd/html.tar.bz2 	html cgi-bin
cd /
  tar -jpc -f $others/etc.tar.bz2	etc
cd /usr/
  tar -jpc -f $others/local.tar.bz2	local

# 2. å…³æ–¼ä½¿ç”¨è€…å‚æ•°æ–¹é¢
cp -a /etc/{passwd,shadow,group}	$userinfod
cd /var/spool
  tar -jpc -f $userinfod/mail.tar.bz2	mail
cd /
  tar -jpc -f $userinfod/home.tar.bz2	home
cd /var/spool
  tar -jpc -f $userinfod/cron.tar.bz2	cron at

[root@www ~]# <span class="term_command">chmod 700 /backup/backupwk.sh</span>
[root@www ~]# <span class="term_command">/backup/backupwk.sh</span>  <span class="term_note">&lt;==è®°å¾—è‡ªå·±è¯•è·‘çœ‹çœ‹ï¼</span>
</pre></td></tr></tbody></table>

		<p>ä¸Šé¢çš„ script ä¸»è¦å‡ä½¿ç”¨ CentOS 5.x (ç†è®ºä¸Šï¼Œ Red Hat ç³»åˆ—çš„ Linux éƒ½æ˜¯ç”¨) é»˜è®¤çš„æœåŠ¡ä¸ç›®å½•ï¼Œ
		å¦‚æœä½ æœ‰é…ç½®æŸäº›æœåŠ¡çš„æ•°æ®åœ¨ä¸åŒçš„ç›®å½•æ—¶ï¼Œé‚£ä¹ˆä¸Šé¢çš„ script æ˜¯è¿˜éœ€è¦ä¿®æ”¹çš„ï¼ä¸è¦åªæ˜¯æ‹¿æ¥ç”¨è€Œå·²å–”ï¼
		ä¸Šé¢ script å¯ä»¥åœ¨åº•ä¸‹çš„è¿ç»“å–å¾—ã€‚</p>

		<ul><li><a href="0580backup/backupwk-0.1.sh" target="_blank">http://vbird.dic.ksu.edu.tw/linux_basic/0580backup/backupwk-0.1.sh</a></li></ul>
	</div>

	<hr><a name="daily"></a><img src="../image/logo.png" alt="å°æ ‡é¢˜çš„å›¾ç¤º" width="24" align="middle" height="23"><span class="text_h2">æ¯æ—¥å¤‡ä»½æ•°æ®çš„ script</span><br>
	<div class="block2">
		<p>å†æ¥ï¼Œç»§ç»­æä¾›ä¸€ä¸‹æ¯æ—¥å¤‡ä»½æ•°æ®çš„è„šæœ¬ç¨‹åºï¼è¯·æ³¨æ„ï¼Œé¸Ÿå“¥è¿™é‡Œä»…æœ‰æä¾› MySQL çš„æ•°æ®åº“å¤‡ä»½ç›®å½•ï¼Œ
		ä¸ WWW çš„ç±»ä¼¼ç•™è¨€ç‰ˆç¨‹åºä½¿ç”¨çš„ CGI ç¨‹åºä¸å†™å…¥çš„æ•°æ®è€Œå·²ã€‚
		å¦‚æœä½ è¿˜æœ‰å…¶ä»–çš„æ•°æ®éœ€è¦æ¯æ—¥å¤‡ä»½ï¼Œè¯·è‡ªè¡Œç…§æ ·é€ å¥ç½—ï¼ ^_^</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /backup/backupday.sh</span>
#!/bin/bash
# =========================================================
# è¯·è¾“å…¥ï¼Œä½ æƒ³è®©å¤‡ä»½æ•°æ®æ”¾ç½®åˆ°é‚£ä¸ªç‹¬ç«‹çš„ç›®å½•å»
<span class="term_write">basedir=/backup/daily/</span>  <span class="term_note">&lt;==ä½ åªè¦æ”¹è¿™é‡Œå°±å¯ä»¥äº†ï¼</span>

# =========================================================
PATH=/bin:/usr/bin:/sbin:/usr/sbin; export PATH
export LANG=C
basefile1=$basedir/mysql.$(date +%Y-%m-%d).tar.bz2
basefile2=$basedir/cgi-bin.$(date +%Y-%m-%d).tar.bz2
[ ! -d "$basedir" ] &amp;&amp; mkdir $basedir

# 1. MysQL (æ•°æ®åº“ç›®å½•åœ¨ /var/lib/mysql)
cd /var/lib
  tar -jpc -f $basefile1 mysql

# 2. WWW çš„ CGI ç¨‹åº (å¦‚æœæœ‰ä½¿ç”¨ CGI ç¨‹åºçš„è¯)
cd /var/www
  tar -jpc -f $basefile2 cgi-bin

[root@www ~]# <span class="term_command">chmod 700 /backup/backupday.sh</span>
[root@www ~]# <span class="term_command">/backup/backupday.sh</span>  <span class="term_note">&lt;==è®°å¾—è‡ªå·±è¯•è·‘çœ‹çœ‹ï¼</span>
</pre></td></tr></tbody></table>

		<p>ä¸Šé¢çš„è„šæœ¬å¯ä»¥åœ¨åº•ä¸‹çš„è¿ç»“å–å¾—ã€‚è¿™æ ·ä¸€æ¥æ¯å¤©çš„ MySQL æ•°æ®åº“å°±å¯ä»¥è‡ªåŠ¨çš„è¢«è®°å½•åœ¨ /backup/daily/ 
		ç›®å½•é‡Œå¤´å•¦ï¼è€Œä¸”è¿˜æ˜¯æ–‡ä»¶åç§°ä¼šè‡ªåŠ¨æ”¹å˜çš„å‘¦ï¼å‘µå‘µï¼æˆ‘å¾ˆå–œæ¬¢ï¼OKï¼å†æ¥å°±æ˜¯å¼€å§‹è®©ç³»ç»Ÿè‡ªå·±è·‘å•¦ï¼
		æ€ä¹ˆè·‘ï¼Ÿå°±æ˜¯ /etc/crontab å‘€ï¼æä¾›ä¸€ä¸‹æˆ‘çš„ç›¸å…³é…ç½®å‘¦ï¼</p>

		<ul><li><a href="0580backup/backupday.sh" target="_blank">http://vbird.dic.ksu.edu.tw/linux_basic/0580backup/backupday.sh</a></li></ul>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /etc/crontab</span>
<span class="term_say"># åŠ å…¥è¿™ä¸¤è¡Œå³å¯ (è¯·æ³¨æ„ä½ çš„æ–‡ä»¶ç›®å½•ï¼ä¸è¦ç…§æŠ„å‘¦ï¼)</span>
<span class="term_write">30 3 * * 0 root /backup/backupwk.sh
30 2 * * * root /backup/backupday.sh</span>
</pre></td></tr></tbody></table>

		<p>è¿™æ ·ç³»ç»Ÿå°±ä¼šè‡ªåŠ¨çš„åœ¨æ¯å¤©çš„ 2:30 è¿›è¡Œ MySQL çš„å¤‡ä»½ï¼Œè€Œåœ¨æ¯ä¸ªæ˜ŸæœŸæ—¥çš„
		3:30 è¿›è¡Œé‡è¦æ–‡ä»¶çš„å¤‡ä»½ï¼å‘µå‘µï¼ä½ è¯´ï¼Œæ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“å‘¢ï¼ä½†æ˜¯è¯·åƒä¸‡è®°å¾—å‘¦ï¼è¿˜è¦å°†
		/backup/ å½“ä¸­çš„æ•°æ® copy å‡ºæ¥æ‰è¡Œè€¶ï¼å¦åˆ™æ•´éƒ¨ç³»ç»Ÿæ­»æ‰çš„æ—¶å€™...é‚£å¯ä¸æ˜¯é—¹è‘—ç©çš„ï¼
		æ‰€ä»¥é¸Ÿå“¥å¤§çº¦ä¸€ä¸ªæœˆåˆ°ä¸¤ä¸ªæœˆä¹‹é—´ï¼Œä¼šå°† /backup ç›®å½•å†…çš„æ•°æ®ä½¿ç”¨ DVD å¤åˆ¶ä¸€ä¸‹ï¼Œç„¶åå°† DVD
		æ”¾ç½®åœ¨å®¶ä¸­ä¿å­˜ï¼è¿™ä¸ª DVD å¾ˆé‡è¦çš„å–”ï¼ä¸å¯ä»¥é—å¤±ï¼Œå¦åˆ™ç³»ç»Ÿçš„é‡è¦æ•°æ® (å°¤å…¶æ˜¯å¸å·èµ„è®¯) 
		æµå‡ºå»å¯ä¸æ˜¯é—¹è‘—ç©çš„ï¼</p>

		<div style="padding: 10pt 0pt;" align="right"><table width="90%"><tbody><tr><td><b>Tips:</b><br><span style="color: rgb(0, 144, 0);"><font size="-1">		æœ‰äº›æ—¶å€™ï¼Œä½ åœ¨è¿›è¡Œå¤‡ä»½æ—¶ï¼Œè¢«å¤‡ä»½çš„æ–‡ä»¶å¯èƒ½åŒæ—¶é—´è¢«å…¶ä»–çš„ç½‘ç»œæœåŠ¡æ‰€ä¿®æ”¹å–”ï¼
		ä¸¾ä¾‹æ¥è¯´ï¼Œå½“ä½ å¤‡ä»½ MySQL æ•°æ®åº“æ—¶ï¼Œåˆšå¥½æœ‰äººåˆ©ç”¨ä½ çš„æ•°æ®åº“å‘è¡¨æ–‡ç« ï¼Œæ­¤æ—¶ï¼Œ
		å¯èƒ½ä¼šå‘ç”Ÿä¸€äº›é”™è¯¯çš„ä¿¡æ¯ã€‚è¦é¿å…è¿™ç±»çš„é—®é¢˜æ—¶ï¼Œå¯ä»¥åœ¨å¤‡ä»½å‰ï¼Œå°†è¯¥æœåŠ¡å…ˆå…³æ‰ï¼Œ
		å¤‡ä»½å®Œæˆåï¼Œå†å¯åŠ¨è¯¥æœåŠ¡å³å¯ï¼æ„Ÿè°¢è®¨è®ºåŒº duncanlo æä¾›è¿™ä¸ªæ–¹æ³•ï¼
		</font></span></td><td><img src="0580backup_files/vbird_face.gif" alt="é¸Ÿå“¥çš„å›¾ç¤º" title="é¸Ÿå“¥çš„å›¾ç¤º"></td></tr></tbody></table></div>	</div>

	<hr><a name="remote"></a><img src="../image/logo.png" alt="å°æ ‡é¢˜çš„å›¾ç¤º" width="24" align="middle" height="23"><span class="text_h2">è¿œç¨‹å¤‡æ´çš„ script</span><br>
	<div class="block2">
		<p>å¦‚æœä½ æœ‰æ§ç®¡ä¸¤éƒ¨ä»¥ä¸Šçš„ Linux ä¸»æœºæ—¶ï¼Œé‚£ä¹ˆäº’ç›¸å°†å¯¹æ–¹çš„é‡è¦æ•°æ®ä¿å­˜ä¸€ä»½åœ¨è‡ªå·±çš„ç³»ç»Ÿä¸­ä¹Ÿæ˜¯ä¸ªä¸é”™çš„æƒ³æ³•ï¼
		é‚£æ€ä¹ˆä¿å­˜å•Šï¼Ÿä½¿ç”¨ Uç›˜ å¤åˆ¶æ¥å»å—ï¼Ÿå½“ç„¶ä¸æ˜¯å•¦ï¼ä½ å¯ä»¥é€è¿‡ç½‘ç»œæ¥å¤„ç½®å•¦ï¼æˆ‘ä»¬å‡è®¾ä½ å·²ç»æœ‰ä¸€éƒ¨ä¸»æœºï¼Œ
		è¿™éƒ¨ä¸»æœºçš„ IP æ˜¯ 192.168.1.100 ï¼Œè€Œä¸”è¿™éƒ¨ä¸»æœºå·²ç»æä¾›äº† FTP ä¸ sshd è¿™ä¸¤ä¸ªç½‘ç»œæœåŠ¡ï¼Œ
		åŒæ—¶ä½ å·²ç»åšå¥½äº† FTP çš„å¸å·ï¼Œsshd å¸å·çš„å…å£ä»¤ç™»é™†åŠŸèƒ½ç­‰ 
		(è¿™éƒ¨åˆ†è¯·å‚è€ƒæœåŠ¡å™¨ç¯‡çš„ä»‹ç»)ï¼Œæ¥ä¸‹æ¥ä½ å¯ä»¥è¿™æ ·åšï¼š<br><br></p>

		<hr><ul class="list1"><li class="text_import1">ä½¿ç”¨ FTP ä¸Šä¼ å¤‡ä»½æ•°æ®</li></ul>

		<p>å‡è®¾ä½ è¦ä¸Šä¼ çš„æ•°æ®æ˜¯å°† /backup/weekly/ ç›®å½•å†…çš„æ–‡ä»¶ç»Ÿæ•´ä¸ºä¸€ä¸ª /backup/weekly.tar.bz2 ï¼Œ
		å¹¶ä¸”ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯çš„ /home/backup/ åº•ä¸‹ï¼Œä½¿ç”¨çš„å¸å·æ˜¯ dmtsai ï¼Œå£ä»¤æ˜¯ dmtsai.pass ã€‚
		é‚£ä¹ˆä½ å¯ä»¥è¿™æ ·åšçœ‹çœ‹ï¼š</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /backup/ftp.sh</span>
#!/bin/bash
# ===========================================
# å…ˆè¾“å…¥ç³»ç»Ÿæ‰€éœ€è¦çš„æ•°æ®
host="192.168.1.100"		# è¿œç¨‹ä¸»æœº
id="dmtsai"			# è¿œç¨‹ä¸»æœºçš„ FTP å¸å·
pw='dmtsai.pass'		# è¯¥å¸å·çš„å£ä»¤
basedir="/backup/weekly"	# æœ¬åœ°ç«¯çš„æ¬²è¢«å¤‡ä»½çš„ç›®å½•
remotedir="/home/backup"	# å¤‡ä»½åˆ°è¿œç¨‹çš„ä½•å¤„ï¼Ÿ

# ===========================================
backupfile=weekly.tar.bz2
cd $basedir/..
  tar -jpc -f $backupfile $(basename $basedir)

ftp -n "$host" &gt; ${basedir}/../ftp.log 2&gt;&amp;1 &lt;&lt;EOF
user $id $pw
binary
cd $remotedir
put $backupfile
bye
EOF
</pre></td></tr></tbody></table>

		<hr><ul class="list1"><li class="text_import1">ä½¿ç”¨ rsync ä¸Šä¼ å¤‡ä»½æ•°æ®</li></ul>

		<p>å¦ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•å°±æ˜¯é€è¿‡ rsync ï¼Œä½†æ˜¯ä½ å¿…é¡»è¦åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šé¢å–å¾—æŸä¸ªå¸å·ä½¿ç”¨æƒåï¼Œ
		å¹¶è®©è¯¥å¸å·å¯ä»¥ä¸ç”¨å£ä»¤å³å¯ç™»é™†æ‰è¡Œï¼è¿™éƒ¨åˆ†å¾—è¦å…ˆå‚è€ƒæœåŠ¡å™¨ç¯‡çš„è¿œç¨‹è¿çº¿æœåŠ¡å™¨æ‰è¡Œï¼
		å‡è®¾ä½ å·²ç»é…ç½®å¥½ dmtsai è¿™ä¸ªå¸å·å¯ä»¥ä¸ç”¨å£ä»¤å³å¯ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼Œè€ŒåŒæ ·çš„ä½ è¦è®© /backup/weekly/
		æ•´ä¸ªå¤‡ä»½åˆ° /home/backup/weekly åº•ä¸‹æ—¶ï¼Œå¯ä»¥ç®€å•è¿™æ ·åšï¼š</p>

<table class="term"><tbody><tr><td class="term"><pre>[root@www ~]# <span class="term_command">vi /backup/rsync.sh</span>
#!/bin/bash
remotedir=/home/backup/
basedir=/backup/weekly
host=127.0.0.1
id=dmtsai

# åº•ä¸‹ä¸ºç¨‹åºé˜¶æ®µï¼ä¸éœ€è¦ä¿®æ”¹å–”ï¼
rsync -av -e ssh $basedir ${id}@${host}:${remotedir}
</pre></td></tr></tbody></table>

		<p>ç”±æ–¼ rsync å¯ä»¥é€è¿‡ ssh æ¥è¿›è¡Œé•œåƒå¤‡ä»½ï¼Œæ‰€ä»¥æ²¡æœ‰å˜æ›´çš„æ–‡ä»¶å°†ä¸éœ€è¦ä¸Šä¼ çš„ï¼ç›¸å½“çš„å¥½ç”¨å‘¢ï¼
		å¥½äº†ï¼å¤§å®¶èµ¶ç´§å†™ä¸€ä¸ªé€‚åˆè‡ªå·±çš„å¤‡ä»½ script æ¥è¿›è¡Œå¤‡ä»½çš„è¡Œä¸ºå§ï¼é‡è¦é‡è¦å–”ï¼</p>
	</div>
</div>
<hr />
    </td>
    <td style="width: 16px; font-size: 6px;">ã€€</td></tr>
<tr><td style="width: 16px; height: 16px;">ã€€</td>
    <td style="width: 866px; height: 16px;">ã€€</td>
    <td style="width: 16px; height: 16px;">ã€€</td></tr>
</tbody></table>

<div style="padding-top: 0px; text-align: center;">
<span style="font-size: 80%;">
	<a href="http://vbird.dic.ksu.edu.tw/" target="_top" title="å‰å¾€é¸Ÿå“¥çš„é¦–é¡µ">http://linux.vbird.org</a>
	is designed by <a href="mailto:vbird@mail.vbird.idv.tw" title="è”ç»œé¸Ÿå“¥(æˆ‘ä¸è¦å¹¿å‘Šä¿¡ï¼)">VBird</a>
		during 2001-2011. <a href="http://www.ksu.edu.tw/" target="_blank">ksu.edu</a></span>
         ï»¿<div id="apDiv4">
      <p>æœ¬ç½‘é¡µä¸»è¦ä»¥Firefoxé…åˆè§£æåº¦ 1024x768 ä½œä¸ºè®¾è®¡ä¾æ®&nbsp;&nbsp;&nbsp;&nbsp; é¸Ÿå“¥è‡ªç”±è½¯ä»¶æ•´åˆåº”ç”¨ç ”ç©¶å®¤</p></div></div>
</div>
</center>
</body></html>
